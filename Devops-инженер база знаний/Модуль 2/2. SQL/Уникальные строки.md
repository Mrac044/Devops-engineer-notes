запрос на выборку из таблицы `course_members`:
```sql
SELECT course_id FROM course_members ORDER BY course_id;
```

|course_id|
|---|
|2|
|10|
|12|
|12|
|15|
|...|

[View on DB Fiddle](https://www.db-fiddle.com/f/o4cwqPm3MDY1oXsv3Ymnqm/0)

## Как убрать повторяющиеся строки

#SQL-команда **оператор `DISTINCT`** - удаляет повторяющиеся строки запроса и оставляет только уникальные. Запрос будет выглядеть так:

```sql
SELECT DISTINCT course_id FROM course_members ORDER BY course_id;
```

|course_id|
|---|
|2|
|10|
|12|
|15|
|...|

[View on DB Fiddle](https://www.db-fiddle.com/f/o4cwqPm3MDY1oXsv3Ymnqm/1)

По отдельности курсы и слушатели могут повторяться, но их сочетание будет уникальным:

```sql
-- DISTINCT добавляется в запрос только один раз,
-- независимо от того, сколько колонок перечисляется
SELECT DISTINCT
    course_id,
    user_id
FROM course_members ORDER BY course_id;
```

|course_id|user_id|
|---|---|
|2|5|
|10|19|
|12|4|
|12|65|
|15|31|

[View on DB Fiddle](https://www.db-fiddle.com/f/o4cwqPm3MDY1oXsv3Ymnqm/2)

## Оператор `DISTINCT ON`

Есть модификация этого оператора — **`DISTINCT ON`**. Такой вариант оператора позволяет указать:

- Поле, которое должно быть уникальным.
- Поля, которые нужно вывести.

#SQL-команда Так выглядит запрос с `DISTINCT ON`:

```sql
SELECT DISTINCT ON (course_id)
    course_id,
    created_at
FROM course_members
ORDER BY course_id, created_at;
```
В нашем запросе идентификаторы курсов не повторяются, а в качестве `created_at` выводится первая дата выбора курса.
[View on DB Fiddle](https://www.db-fiddle.com/f/o4cwqPm3MDY1oXsv3Ymnqm/5)

## Сортировка с оператором `DISTINCT ON`
==При работе с `DISTINCT ON` важно правильно использовать сортировку. Первыми полями в `ORDER BY` должны быть те, которые идут после `DISTINCT ON`.==

Для примера напишем еще один запрос — к каждому уникальному курсу выведем дату, в которую записался последний студент.
```sql
SELECT DISTINCT ON (course_id)
    course_id,
    created_at
FROM course_members
ORDER BY course_id, created_at DESC;
```

[View on DB Fiddle](https://www.db-fiddle.com/f/o4cwqPm3MDY1oXsv3Ymnqm/7)

## Дополнительные материалы

- [DISTINCT](https://postgrespro.ru/docs/postgresql/15/sql-select#SQL-DISTINCT)