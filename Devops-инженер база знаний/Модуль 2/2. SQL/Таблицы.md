### Типы данных
У каждого поля в PostgreSQL определенный тип, который задается на этапе создания таблицы.

#### Строки

Для строк в базах данных в основном используются два типа:

- _varchar_ -- для строк с ограничением максимальной длины
- _text_ -- для строк без ограничения. Как правило, это полноценные тексты

В базах данных нельзя оставить первый тип без указания длины. Это связано с производительностью и эффективностью.

Если размер данных не известен, то придется просматривать весь файл в поисках нужного значения. Чтобы избежать подобной ситуации, тип _text_ хранится отдельно.
==Если размер строки известен или он меньше какого-то значения, то предпочтительнее использовать _varchar_.==

#SQL-команда Пример создания таблицы с такими типами:

```sql
CREATE TABLE topics (
    title varchar(255),
    body text
);
```

#SQL-команда Для строк в SQL используют одинарные кавычки:

```sql
INSERT INTO topics (body, title) VALUES ('Architecto id autem modi.', 'est iste corporis');
```

#SQL-команда Если размер строки превышает допустимую, то запрос завершится с ошибкой:

```
INSERT INTO topics (body, title) VALUES ('Architecto id autem modi.', 'Explicabo inventore molestiae consequatur commodi velit quasi itaque. Qui ducimus ad. Voluptatibus dolores consequatur nemo excepturi vitae minima inventore voluptas. Quo dolorem ab eligendi qui similique suscipit aperiam eius. Et est odio iusto repellendus. Odio ea voluptatem voluptatem expedita inventore maiores ad unde');
Query Error: error: value too long for type character varying(255)
```

#### Числа

Для чисел в основном используются два типа данных: _integer_ и _bigint_. Какой конкретно указывать тип, зависит от потенциального потолка значения. Ниже указаны диапазоны, допустимые в рамках этих типов:

| Имя     | Описание                                  | Диапазон                                                          |
| ------- | ----------------------------------------- | ----------------------------------------------------------------- |
| integer | типичный выбор для целых чисел            | -2147483648 .. +2147483647                                        |
| bigint  | целое в большом диапазоне                 | -9223372036854775808 .. 9223372036854775807                       |
| real    | вещественное число с переменной точностью | -2147483648 .. +2147483647, точность в пределах 6 десятичных цифр |
#SQL-команда Пример создания таблицы с такими типами:

```sql
CREATE TABLE users (
    id          bigint,
    age         integer,
    weight      real
);

INSERT INTO users (id, age, weight) VALUES (1, 38, 67.4);
INSERT INTO users (id, age, weight) VALUES (2, 15, 54.3);
```
[View On DB Fiddle](https://www.db-fiddle.com/f/n7TRA2GoFkBBjQazr6S8mH/1)

#SQL-команда Также, как и со строками, если попытаться вставить недопустимое значение, то запрос упадет с ошибкой

```sql
CREATE TABLE users (
    id          bigint,
    age         integer,
    weight      real
);
-- Пробуем вставить в age больше 3 миллиардов
INSERT INTO users (id, age, weight) VALUES (3, 3147483648, 67.4);
Schema Error: error: integer out of range
```

==Полный список типов данных можно посмотреть в [документации](https://postgrespro.ru/docs/postgrespro/16/datatype-numeric).==

#### Даты

Нам надо хранить день без конкретного времени? 
Это тип _date_. 
Нужно конкретный момент времени, 
тогда _timestamp_. 
Просто время без даты? 
Тогда _time_.

|Имя|Описание|Наименьшее значение|Наибольшее значение|Точность|
|---|---|---|---|---|
|timestamp|дата и время (без часового пояса)|4713 до н. э.|294276 н. э.|1 микросекунда|
|date|дата (без времени суток)|4713 до н. э.|5874897 н. э.|1 день|
|time|время суток (без даты)|00:00|24:00|1 микросекунда|
#SQL-команда Пример создания таблицы с такими типами:

```sql
CREATE TABLE users (
    id bigint,
    username VARCHAR(50),
    birthday DATE,
    updated_at TIMESTAMP,
    created_at TIMESTAMP
);

INSERT INTO users (id, username, birthday, created_at, updated_at) VALUES (1, 'Duncan3', '2022-05-25', '2022-06-14 18:31:05.296', '2022-06-14 18:31:05.296');
INSERT INTO users (id, username, birthday, created_at, updated_at) VALUES (2, 'Jennyfer', '2022-01-13', '2022-06-14 02:04:13.104', '2022-06-14 02:04:13.104');
```
[View On DB Fiddle](https://www.db-fiddle.com/f/wD1zqJASvze9mwmc1sCJwt/2)

==Хорошей практикой считается добавление и заполнение полей _created_at_ и _updated_at_ в каждую таблицу базы данных. С их помощью всегда можно узнать, когда запись создалась и обновилась.==

#### Логический тип

Содержит всего два значения: `true` и `false`. Этот тип используется для флагов:

|Имя|Описание|
|---|---|
|boolean|true или false (истина или ложь)|

#SQL-команда Пример создания таблицы с такими типами:

```sql
CREATE TABLE users (
    id bigint,
    username VARCHAR(50),
    email_confirmed BOOLEAN,
    email VARCHAR(255)
);

INSERT INTO users (id, username, email, email_confirmed) VALUES (1, 'Duncan3', 'duncan3@example.com', TRUE);
INSERT INTO users (id, username, email, email_confirmed) VALUES (2, 'Jenny', 'jenny@example.com', FALSE);
```
[View On DB Fiddle](https://www.db-fiddle.com/f/3GCDe32vMqstS7jy5GBAuX/0)

Состояние «true» может задаваться следующими значениями:

```
TRUE
't'
'true'
'y'
'yes'
'on'
'1'
```

Для состояния «false» можно использовать следующие варианты:

```
FALSE
'f'
'false'
'n'
'no'
'off'
'0'
```

Недопустимое значение в колонке _boolean_ не будет сохранено

```sql
INSERT INTO users (id, username, email, email_confirmed) VALUES (1, 'Duncan3', 'duncan3@example.com', 1);
Schema Error: error: column "email_confirmed" is of type boolean but expression is of type integer
```

#### NULL

Помимо типов данных для реальных значений, в базе существует специальное значение `NULL`, чтобы обозначать пустоту. Тип поля при этом не важен.

```sql
CREATE TABLE topics (
   user_id integer,
   body text
);

INSERT INTO topics (user_id, body) VALUES
(1, 'Классный курс!'),
(2, NULL);
```
[View On DB Fiddle](https://www.db-fiddle.com/f/raSxZwU1twwCdTSb4LNF5E/1)

#SQL-команда Воспользуемся изученными типами данных, чтобы создать таблицу сотрудников

```sql
CREATE TABLE users (
    id bigint,
    username VARCHAR(50),
    birthday DATE,
    email_confirmed BOOLEAN,
    email VARCHAR(255),
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);

CREATE TABLE topics (
    id bigint PRIMARY KEY,
    user_id bigint,
    title varchar(255),
    body text,
    updated_at TIMESTAMP,
    created_at TIMESTAMP
);

CREATE TABLE courses (
    id bigint,
    name varchar(255),
    body text,
    updated_at TIMESTAMP,
    created_at TIMESTAMP
);
```

## Выводы

В этом уроке мы познакомились с типами данных в таблице. Повторим ключевые моменты:

- В каждом столбце должны храниться однородные данные. Это необходимо для удобства и безопасности работы с данными
- Типы данных в SQL накладывают ограничения на хранящиеся данные и операции, которые можно с ними совершать
- Типы данных указываются при создании таблицы
- Попытка вставить данные неподходящего типа или значения в колонку приведет к ошибке
- Для строк используются такие типы данных как _varchar_ и _text_
- Для строк необходимо использовать одинарные кавычки
- Для чисел используются типы _integer_, _bigint_, _real_
- Для даты и времени используют _timestamp_, _date_, _time_
- Для логических значений используют тип _boolean_. Эти значения чаще всего бывают в колонках-флагах
- Когда у поля нет конкретного значения, используют специальное значение `NULL`
## Самостоятельная работа

Немного попрактикуемся с созданием таблицы.

Структура `students`:

- `id` — идентификатор студента, целое число.
- `first_name` — имя студента, строка.
- `last_name` — фамилия студента, строка.
- `email` — электронная почта, строка.
- `bio` — текст о студенте. Может содержать много текста.
- `is_studying` — текущий статус студента, учится ли он или нет.
- `updated_at` — дата и время обновления записи.
- `created_at` — дата и время создания записи.

На [DBFiddle](https://www.db-fiddle.com/f/nTo8up2nSEQV3L1VvWSkHG/32) мы подготовили часть запроса. Впишите между комментариями `BEGIN` и `END` запрос на создание таблицы и нажмите _Run_, чтобы проверить результат.

```sql
CREATE TABLE students (
    id BIGINT,
    first_name VARCHAR(255),
    last_name VARCHAR(255),
    email VARCHAR(255),
    bio TEXT,
    is_studying BOOLEAN,
    updated_at TIMESTAMP,
    created_at TIMESTAMP
);
```

## Дополнительные материалы

- [Онлайн-песочница для выполнения SQL-запросов](https://www.db-fiddle.com/)
    
- [Типы данных](https://postgrespro.ru/docs/postgresql/15/datatype)
    
- [CREATE TABLE](https://www.postgresql.org/docs/current/static/sql-createtable.html)