Чтобы вызвать агрегатную функцию, нужно написать ее имя и затем в круглых скобках передать **аргументы** — переменные, над которыми будут совершаться действия.

## Функция `COUNT`

#SQL-команда **Функция `COUNT`** — она возвращает количество записей в выборке.

Ответить на вопрос «А сколько записей содержится в таблице `users`?» можно с помощью такого запроса:

```sql
SELECT COUNT(*) FROM users;
```

|count|
|---|
|99|

[View on DB Fiddle](https://www.db-fiddle.com/f/bJdbuHNTSwFM8ZKqn76AwV/1)

#SQL-команда в качестве аргумента мы можем передать имя поля. В этом случае функция вернет нам количество строк, в которых поле НЕ равно `NULL`. Выполним такой запрос:

```sql
SELECT COUNT(id) FROM users;
```

|count|
|---|
|99|
==Этот запрос также вернул значение `99` — это количество строк, `id` которых не равен `NULL`.==
[View on DB Fiddle](https://www.db-fiddle.com/f/bJdbuHNTSwFM8ZKqn76AwV/2)

#SQL-команда Обратите внимание, что `COUNT` возвращает количество записей в запросе, а не в таблице:

```sql
SELECT COUNT(*) FROM users WHERE gender = 'female';
```

|count|
|---|
|56|

[View on DB Fiddle](https://www.db-fiddle.com/f/bJdbuHNTSwFM8ZKqn76AwV/4)

## Функция `SUM`

#SQL-команда Функция **`SUM`** возвращает сумму всех значений:

```sql
SELECT SUM(spent_minutes) FROM course_reviews;
```

|sum|
|---|
|2456|

[View on DB Fiddle](https://www.db-fiddle.com/f/bJdbuHNTSwFM8ZKqn76AwV/5)

```sql
-- Передадим поле с датами создания — запрос вернет ошибку
SELECT SUM(created_at) FROM course_reviews;

-- Передадим символ '*' — запрос завершится с ошибкой
SELECT SUM(*) FROM course_reviews;
```

```
Query Error: error: function sum(timestamp without time zone) does not exist
Query Error: error: function sum() does not exist
```

[View on DB Fiddle](https://www.db-fiddle.com/f/bJdbuHNTSwFM8ZKqn76AwV/6)

## Функция `AVG`

**Функция `AVG`** - находить среднее арифметическое
![[Pasted image 20260207001753.png]]

#SQL-команда Найдем среднее время, проведенное пользователем с `id = 9` на площадке онлайн-школы:

```sql
SELECT AVG(spent_minutes) FROM course_reviews WHERE user_id = 9;
```

|avg|
|---|
|25.6666666666666667|

[View on DB Fiddle](https://www.db-fiddle.com/f/bJdbuHNTSwFM8ZKqn76AwV/7)

## Функции `MAX` и `MIN`

#SQL-команда Функции `MAX` и `MIN` позволяют найти максимальное и минимальное значение соответственно. Найдем максимальное время прохождения курса:

```sql
SELECT MAX(spent_minutes) FROM course_reviews;
```

|max|
|---|
|100|

[View on DB Fiddle](https://www.db-fiddle.com/f/bJdbuHNTSwFM8ZKqn76AwV/8
==В качестве аргументов в функции `MAX` и `MIN` можно передавать поля числовых типов, а так же даты и строки. Для строк минимальное и максимальное значения — это первая и последняя строки, упорядоченные по алфавиту:==

```sql
SELECT MIN(username) FROM users;
```

|min|
|---|
|Abelardo58|

[View on DB Fiddle](https://www.db-fiddle.com/f/bJdbuHNTSwFM8ZKqn76AwV/10)

Запрос с функцией `MIN` выведет пользователя `Abelardo58`, потому что он идет первым по алфавиту.

Рассмотрим еще один пример:
```sql
SELECT MAX(username) FROM users;
```

|max|
|---|
|Zoey24|

[View on DB Fiddle](https://www.db-fiddle.com/f/bJdbuHNTSwFM8ZKqn76AwV/11)

Запрос с функцией `MAX` выведет пользователя `Zoey24`, потому что он идет по алфавиту последним.

## Выводы

В этом уроке мы познакомились с агрегатными функциями:

- `COUNT` - позволяет подсчитать количество строк
- `SUM` - позволяет найти сумму чисел
- `AVG` - позволяет подсчитать среднее арифметическое
- `MAX` - возвращает максимальное значение численного поля или последнюю строку по алфавиту
- `MIN` - возвращает минимальное значение численного поля или первую строку по алфавиту

## Дополнительные материалы

- [AGGREGATE FUNCTIONS](https://www.postgresql.org/docs/current/functions-aggregate.html)