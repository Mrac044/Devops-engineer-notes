В этом уроке мы разберем, как сортировать данные в базе в том порядке, который нам нужен. Для этого используется запрос **`ORDER BY`**.

## Как устроен запрос на сортировку

![[Pasted image 20260206232944.png]]

#SQL-команда Сортировка задается с помощью оператора `ORDER BY`. За ней следует имя поля, по которому происходит сортировка:

```sql
SELECT
    id,
    username,
    created_at
FROM users ORDER BY username;
```

|id|username|
|---|---|
|12|Abelardo58|
|33|Alanna99|
|58|Alena17|
|39|Alfonzo_Lehner|
|44|Amely1|
|...||

[View on DB Fiddle](https://www.db-fiddle.com/f/pFhJCCMBU61afBV9fJUyre/0)

==Если порядок не указан, то сортировка происходит по возрастанию `ASC`.==

База данных знает, как сравнивать не только числа, но и строки, и даты. #SQL-команда Сортировка по датам — крайне частая операция, выглядит она идентично любой другой сортировке:

```sql
SELECT
    id,
    username,
    created_at
FROM users ORDER BY created_at;
```
Здесь мы отсортировали пользователей по дате создания в прямом порядке, то есть по возрастанию.

|id|username|created_at|
|---|---|---|
|16|Davonte78|2022-06-13T20:45<br><br>.590Z|
|61|Carmela.Raynor42|2022-06-13T20:49<br><br>.072Z|
|67|Gertrude_Hand29|2022-06-13T20:49<br><br>.486Z|
|46|Edd_Harris|2022-06-13T20:58<br><br>.247Z|
|13|Tina_Huels|2022-06-13T20:59<br><br>.222Z|
|...|||

[View on DB Fiddle](https://www.db-fiddle.com/f/pFhJCCMBU61afBV9fJUyre/1)

## Как управлять порядком сортировки

Сортировать данные можно разными способами:

- В прямом порядке
- В обратном порядке
- По нескольким полям
### Прямой порядок сортировки

Если ничего дополнительно не указывать, то `ORDER BY` сортирует в **прямом порядке** — от меньшего к большему.

#SQL-команда Полный запрос включает в себя `ASC`(возрастающий порядок), который подставляется автоматически, если ничего не указано:

```sql
SELECT
    id,
    username,
    created_at
FROM users ORDER BY created_at ASC;
-- То же самое, что и
SELECT
    id,
    username,
    created_at
FROM users ORDER BY created_at;
```

[View on DB Fiddle](https://www.db-fiddle.com/f/pFhJCCMBU61afBV9fJUyre/10)

### Обратный порядок сортировки

#SQL-команда Чтобы выполнить сортировку в обратном порядке, указываем `DESC`:

```
SELECT
    id,
    username,
    created_at
FROM users
ORDER BY created_at DESC;
```

|id|username|created_at|
|---|---|---|
|76|Janet.Bernier14|2022-06-14T20:35<br><br>.411Z|
|30|Jensen_Raynor61|2022-06-14T20:24<br><br>.485Z|
|78|Tania77|2022-06-14T20:13<br><br>.385Z|
|59|Sylvan_Nader|2022-06-14T20:07<br><br>.356Z|
|50|Kareem12|2022-06-14T19:53<br><br>.086Z|
|...|||

[View on DB Fiddle](https://www.db-fiddle.com/f/pFhJCCMBU61afBV9fJUyre/3)

### Сортировка по нескольким полям

#SQL-команда Сортировки по нескольким полям достичь, если перечислить поля через запятую:

```sql
SELECT
    id,
    username,
    created_at
FROM users ORDER BY username, created_at;
```

|id|username|created_at|
|---|---|---|
|12|Abelardo58|2022-06-14T13:10<br><br>.133Z|
|33|Alanna99|2022-06-14T19:30<br><br>.438Z|
|58|Alena17|2022-06-14T13:10<br><br>.010Z|
|39|Alfonzo_Lehner|2022-06-14T07:35<br><br>.735Z|
|44|Amely1|2022-06-14T18:28<br><br>.986Z|
|...|||

[View on DB Fiddle](https://www.db-fiddle.com/f/pFhJCCMBU61afBV9fJUyre/4)

Порядок сортировки в таком случае задается для каждого поля в отдельности:

```sql
SELECT
    first_name,
    created_at
FROM users
ORDER BY first_name ASC, created_at DESC;
```

|first_name|created_at|
|---|---|
|Abe|2022-06-13T20:45<br><br>.590Z|
|Abigale|2022-06-13T21:38<br><br>.637Z|
|Alejandrin|2022-06-14T13:18<br><br>.695Z|
|Alfreda|2022-06-13T20:59<br><br>.222Z|
|Alfredo|2022-06-14T19:30<br><br>.438Z|
|...||
==В этой выборке сначала выполняется сортировка по имени в прямом порядке. Затем внутри групп с одинаковым именем данные сортируются по `created_at` в обратном порядке.==
[View on DB Fiddle](https://www.db-fiddle.com/f/pFhJCCMBU61afBV9fJUyre/6)

## Как сортировать `NULL`-значения
==В языке SQL нет единого стандарта как сортировать данные с `NULL`, и каждый провайдер, авторы базы данных, решает сам. Поэтому положение `NULL`-значений может отличаться в разных БД. Например, в MySQL `NULL` будут впереди при сортировке по возрастанию, тогда как в PostgreSQL в самом конце.==

#SQL-команда Пример с использованием `NULLS FIRST`:

```sql
-- Сортируем по возрастанию даты, то есть поля `created_at`
-- Поля с `NULL` идут первыми
SELECT
    id,
    username,
    created_at
FROM users ORDER BY created_at ASC NULLS FIRST;
```

[View on DB Fiddle](https://www.db-fiddle.com/f/pFhJCCMBU61afBV9fJUyre/8)

#SQL-команда Пример с использованием `NULLS LAST`:

```sql
-- Сортируем по убыванию даты
-- Поля с `NULL` идут последними
SELECT
    id,
    username,
    created_at
FROM users ORDER BY created_at DESC NULLS LAST;
```

[View on DB Fiddle](https://www.db-fiddle.com/f/pFhJCCMBU61afBV9fJUyre/9)

## Дополнительные материалы

- [Официальная документация](https://postgrespro.ru/docs/postgresql/15/sql-select)